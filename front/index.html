<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="data:image/x-icon;base64,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">
    <title>ESP32 SHT31 Server</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet"> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>
</head>

<body>
    <h1> ESP32 SHT31 Server</h1>
    <div class="sensorData" id="temp">
        <i class="fas fa-thermometer-three-quarters fa-2x" style="color:#ff7b25;"></i>
        <span class="labels"> Temperature:</span>
        <span id="temperature">%TEMPERATURE%</span>
        <sup class = "units">Â°C</sup> 
    </div>

    <div class="chartBox">
        <canvas id="chart_temp" width="400" height="300"></canvas>
    </div>
    

    <div class="sensorData" id="hum">
        <i class="fas fa-tint fa-2x" style="color:#80ced6;"></i>
        <span class="labels"> Humidity:</span>
        <span id="humidity">%HUMIDITY%</span>
        <sup class = "units">%</sup> 
        
    </div>
    <div class="chartBox">
        <canvas id="chart_hum" width="400" height="300"></canvas>
    </div>

        <script>
            const uri_temp = "http://esp-home.local/api/v1/temp/raw"
            const uri_hum = "http://esp-home.local/api/v1/hum/raw"

            const xlabels_temp=[];
            const data_temp = {
                labels: xlabels_temp,
                datasets: [{
                    label: "Temperature reading",
                    backgroundColor: 'rgb(255,123,37)',
                    borderColor: 'rgb(255,123,37)',
                    data: [],
                }]
            }

            const config_temp = {
                type: 'line',
                data: data_temp,
                options: {
                    legend: {
                        display: false
                    },
                    tooltips: {
                        callbacks: {
                        label: function(tooltipItem) {
                                return tooltipItem.yLabel;
                        }
                        }
                    }
                }
            };

            const tempChart = new Chart(
                document.getElementById('chart_temp'),
                config_temp
            );

            const xlabels_hum =[];
            const data_hum = {
                labels: xlabels_hum,
                datasets: [{
                    label: "Humidity reading",
                    backgroundColor: 'rgb(128,206,214)',
                    borderColor: 'rgb(128,206,214)',
                    data: [],
                }]
            }
            const config_hum = {
                type: 'line',
                data: data_hum,
                options: {}
                
            }

            const humChart = new Chart(
                document.getElementById('chart_hum'),
                config_hum
            )

            function addData(chart, label, data) {
                            chart.data.labels.push(label);
                            chart.data.datasets.forEach((dataset) => {
                                dataset.data.push(data);
                            });
                            chart.update();
            }

            async function getTemperatureAndHumidity() {
                fetch(uri_temp)
                    .then((response)=> response.text())
                    .then((dataStr)=> {
                        let data = JSON.parse(dataStr);
                        let temp = data.raw;
                        document.getElementById("temperature").innerHTML = temp.toFixed(2);

                        let today = new Date();
                        let time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
                        addData(tempChart, time, temp);
                    })
                    .catch(function(error){
                        console.log(error);
                    });
                fetch(uri_hum)
                    .then((response)=> response.text())
                    .then((dataStr)=> {
                        let data = JSON.parse(dataStr);
                        let hum = data.raw;
                        document.getElementById("humidity").innerHTML = hum.toFixed(2);
                        
                        let today = new Date();
                        let time = today.getHours() + ":" + today.getMinutes() + ":" + today.getSeconds();
                        addData(humChart, time, hum);

                    })
                    .catch(function(error){
                        console.log(error);
                    });
            }
            
            getTemperatureAndHumidity();
            var interval = setInterval(getTemperatureAndHumidity, 5000);

            


        </script>
        <style>
            html {
                font-family: 'Roboto', sans-serif;
                display: inline-block;
                margin: 0px auto;
                text-align: center;
            }
            h1 {
                font-size: 3.0rem;
            }
            .labels, #humidity, #temperature{
                font-size: 1.5rem;
                vertical-align:middle;
                padding-bottom: 15px;
            }
            .units{
                font-size: 1.2rem;
            }

            .chartBox{
                width: 400px;
                height: 300px;
                position: relative;
                margin: auto;
            }

            div {
                display: block;
                padding-bottom: 20px;
            }

            /* #chart_temp, #chart_hum{
                height: 300px;
            } */
           
        </style>
</body>

</html>